# 🚀 抽签系统启动检查清单

## 前置条件检查

### ✅ 必需软件
- [ ] .NET 8.0 SDK 已安装
  - 检查命令：`dotnet --version`
  - 应显示：8.x.x 或更高版本
  
- [ ] Node.js 已安装
  - 检查命令：`node --version`
  - 应显示：v18.x.x 或更高版本

- [ ] npm 已安装
  - 检查命令：`npm --version`

### ✅ 文件完整性
- [ ] `students.db` 数据库文件存在
- [ ] `lottery-backend/` 文件夹存在
- [ ] `lottery-frontend/` 文件夹存在

## 启动步骤

### 第一步：启动后端

1. [ ] 打开命令行窗口
2. [ ] 进入后端目录：`cd lottery-backend`
3. [ ] 运行：`dotnet run`
4. [ ] 等待看到：`Now listening on: http://localhost:5000`
5. [ ] 保持此窗口打开

**或者直接双击运行 `start-backend.bat`**

### 第二步：启动前端

1. [ ] 打开新的命令行窗口
2. [ ] 进入前端目录：`cd lottery-frontend`
3. [ ] 首次运行需要安装依赖：`npm install`（等待 2-5 分钟）
4. [ ] 运行：`npm run dev`
5. [ ] 等待看到：`Local: http://localhost:5173`
6. [ ] 保持此窗口打开

**或者直接双击运行 `start-frontend.bat`**

### 第三步：访问系统

1. [ ] 打开浏览器
2. [ ] 访问：http://localhost:5173
3. [ ] 应该看到抽签系统界面

## 功能测试

### ✅ 基本功能测试
- [ ] 页面正常显示
- [ ] 能看到学生总数统计
- [ ] 点击"开始抽签"按钮
- [ ] 能看到抽签动画
- [ ] 显示抽中的学生信息

### ✅ 筛选功能测试
- [ ] 选择性别筛选（男/女）
- [ ] 点击抽签，验证抽中的学生性别正确
- [ ] 选择班级筛选
- [ ] 点击抽签，验证抽中的学生班级正确

### ✅ API 测试（可选）
运行 `test-api.bat` 脚本测试所有 API 接口

## 常见问题排查

### ❌ 后端启动失败

**问题：端口被占用**
```
Error: Failed to bind to address http://localhost:5000
```
解决方案：
1. 关闭占用 5000 端口的程序
2. 或修改 `lottery-backend/Properties/launchSettings.json` 中的端口

**问题：找不到数据库**
```
Error: SQLite Error 14: 'unable to open database file'
```
解决方案：
1. 确认 `students.db` 文件在项目根目录
2. 检查文件权限

### ❌ 前端启动失败

**问题：依赖安装失败**
```
npm ERR! code ECONNREFUSED
```
解决方案：
1. 检查网络连接
2. 尝试使用国内镜像：`npm config set registry https://registry.npmmirror.com`
3. 重新运行：`npm install`

**问题：端口被占用**
```
Port 5173 is in use
```
解决方案：
1. 关闭占用 5173 端口的程序
2. Vite 会自动尝试使用 5174 端口

### ❌ 前端无法连接后端

**问题：CORS 错误**
```
Access to fetch at 'http://localhost:5000' has been blocked by CORS policy
```
解决方案：
1. 确认后端已启动
2. 检查后端 Program.cs 中的 CORS 配置
3. 清除浏览器缓存

**问题：网络错误**
```
Failed to fetch
```
解决方案：
1. 确认后端运行在 http://localhost:5000
2. 在浏览器中直接访问 http://localhost:5000/api/lottery/stats
3. 检查防火墙设置

## 成功标志

当你看到以下内容时，说明系统运行正常：

### 后端控制台
```
info: Microsoft.Hosting.Lifetime[14]
      Now listening on: http://localhost:5000
info: Microsoft.Hosting.Lifetime[0]
      Application started. Press Ctrl+C to shut down.
```

### 前端控制台
```
  VITE v7.x.x  ready in xxx ms

  ➜  Local:   http://localhost:5173/
  ➜  Network: use --host to expose
  ➜  press h + enter to show help
```

### 浏览器
- 看到紫色渐变背景
- 显示"🎲 学生抽签系统"标题
- 显示学生总数
- 有"开始抽签"按钮

## 停止系统

1. 在后端命令行窗口按 `Ctrl + C`
2. 在前端命令行窗口按 `Ctrl + C`
3. 或直接关闭命令行窗口

## 下次启动

下次启动时：
1. 后端：直接运行 `start-backend.bat`
2. 前端：直接运行 `start-frontend.bat`（无需再次 npm install）

---

**提示**：建议将两个启动脚本固定到任务栏，方便快速启动！
