<template>
  <div class="paid-prize-container">
    <!-- åŠŸèƒ½ä»‹ç»å¡ç‰‡ -->
    <div class="feature-card">
      <div class="feature-header">
        <h2>ğŸ’ å°Šäº«ä»˜è´¹æŠ½å¥–</h2>
        <p class="feature-subtitle">è§£é”é«˜çº§æŠ½å¥–åŠŸèƒ½ï¼Œäº«å—æ›´å¤šä¸“å±ç‰¹æƒ</p>
      </div>

      <!-- åŠŸèƒ½ç‰¹æƒåˆ—è¡¨ -->
      <div class="features-grid">
        <div class="feature-item">
          <div class="feature-icon">ğŸ¯</div>
          <h3>å®šåˆ¶å¥–æ± </h3>
          <p>è‡ªå®šä¹‰å¥–å“æ± ï¼Œæ”¯æŒæ›´å¤šå¥–é¡¹é…ç½®</p>
        </div>
        <div class="feature-item">
          <div class="feature-icon">ğŸ¨</div>
          <h3>ç‰¹æ•ˆå‡çº§</h3>
          <p>ç‚«é…·æŠ½å¥–åŠ¨ç”»ï¼Œæå‡ä»ªå¼æ„Ÿ</p>
        </div>
        <div class="feature-item">
          <div class="feature-icon">ğŸ“Š</div>
          <h3>æ•°æ®å¯¼å‡º</h3>
          <p>å¯¼å‡ºæŠ½å¥–è®°å½•ï¼Œæ”¯æŒExcelæ ¼å¼</p>
        </div>
        <div class="feature-item">
          <div class="feature-icon">ğŸ†</div>
          <h3>æ— é™æ¬¡æ•°</h3>
          <p>ä¸é™æŠ½å¥–æ¬¡æ•°ï¼Œéšå¿ƒæ‰€æ¬²ä½¿ç”¨</p>
        </div>
      </div>
    </div>

    <!-- ä»·æ ¼å¥—é¤å¡ç‰‡ -->
    <div class="pricing-section">
      <h2 class="pricing-title">é€‰æ‹©æ‚¨çš„å¥—é¤</h2>
      
      <div class="pricing-cards">
        <!-- å•æ¬¡å¥—é¤ -->
        <div class="pricing-card" :class="{ selected: selectedPlan === 'single' }" @click="selectedPlan = 'single'">
          <div class="plan-badge">ä½“éªŒç‰ˆ</div>
          <h3 class="plan-name">å•æ¬¡å¯¼å‡º</h3>
          <div class="plan-price">
            <span class="currency">Â¥</span>
            <span class="amount">1</span>
          </div>
          <ul class="plan-features">
            <li>âœ“ 1æ¬¡æ•°æ®å¯¼å‡ºæƒé™</li>
            <li>âœ“ Excelæ ¼å¼å¯¼å‡º</li>
            <li>âœ“ åŒ…å«æ‰€æœ‰æŠ½å¥–è®°å½•</li>
            <li>âœ— æœ‰æ•ˆæœŸé™åˆ¶</li>
          </ul>
          <button class="plan-button" @click.stop="openPaymentModal('single')">
            ç«‹å³è´­ä¹°
          </button>
        </div>

        <!-- æœˆåº¦å¥—é¤ -->
        <div class="pricing-card popular" :class="{ selected: selectedPlan === 'monthly' }" @click="selectedPlan = 'monthly'">
          <div class="plan-badge popular-badge">æœ€å—æ¬¢è¿</div>
          <h3 class="plan-name">åŒ…æœˆä¼šå‘˜</h3>
          <div class="plan-price">
            <span class="currency">Â¥</span>
            <span class="amount">9.9</span>
            <span class="period">/æœˆ</span>
          </div>
          <ul class="plan-features">
            <li>âœ“ æ— é™æ¬¡æ•°æ®å¯¼å‡º</li>
            <li>âœ“ Excel + CSVæ ¼å¼</li>
            <li>âœ“ æ‰¹é‡å¯¼å‡ºåŠŸèƒ½</li>
            <li>âœ“ æ•°æ®ç»Ÿè®¡æŠ¥è¡¨</li>
            <li>âœ“ 30å¤©æœ‰æ•ˆæœŸ</li>
          </ul>
          <button class="plan-button primary" @click.stop="openPaymentModal('monthly')">
            ç«‹å³è´­ä¹°
          </button>
        </div>
      </div>
    </div>

    <!-- ä½¿ç”¨è¯´æ˜ -->
    <div class="instructions-card">
      <h3>ğŸ“– ä½¿ç”¨è¯´æ˜</h3>
      <ol class="instructions-list">
        <li>é€‰æ‹©é€‚åˆæ‚¨çš„å¥—é¤æ–¹æ¡ˆ</li>
        <li>ç‚¹å‡»"ç«‹å³è´­ä¹°"æŒ‰é’®</li>
        <li>é€‰æ‹©æ”¯ä»˜æ–¹å¼ï¼ˆå¾®ä¿¡/æ”¯ä»˜å®ï¼‰</li>
        <li>æ‰«æäºŒç»´ç å®Œæˆæ”¯ä»˜</li>
        <li>æ”¯ä»˜æˆåŠŸåå³å¯ä½¿ç”¨ä»˜è´¹åŠŸèƒ½</li>
      </ol>
    </div>

    <!-- å¯¼å‡ºåŠŸèƒ½é¢æ¿ -->
    <div class="export-section">
      <ExportPanel />
    </div>

    <!-- æ”¯ä»˜å¼¹çª— -->
    <PaymentModal 
      v-if="showPaymentModal"
      :plan="currentPlan"
      @close="showPaymentModal = false"
      @payment-success="handlePaymentSuccess"
    />
  </div>
</template>

<script setup lang="ts">
import { ref } from 'vue';
import PaymentModal from './PaymentModal.vue';
import ExportPanel from './ExportPanel.vue';

// é€‰ä¸­çš„å¥—é¤
const selectedPlan = ref<'single' | 'monthly'>('monthly');

// æ”¯ä»˜å¼¹çª—çŠ¶æ€
const showPaymentModal = ref(false);
const currentPlan = ref<{
  type: string;
  name: string;
  price: number;
}>({
  type: '',
  name: '',
  price: 0
});

// æ‰“å¼€æ”¯ä»˜å¼¹çª—
const openPaymentModal = (planType: 'single' | 'monthly') => {
  const plans = {
    single: { type: 'single', name: 'å•æ¬¡å¯¼å‡º', price: 1.0 },
    monthly: { type: 'monthly', name: 'åŒ…æœˆä¼šå‘˜', price: 9.9 }
  };
  
  currentPlan.value = plans[planType];
  showPaymentModal.value = true;
};

// æ”¯ä»˜æˆåŠŸå¤„ç†
const handlePaymentSuccess = () => {
  showPaymentModal.value = false;
  // è¿™é‡Œåç»­å¯ä»¥æ·»åŠ æ”¯ä»˜æˆåŠŸåçš„é€»è¾‘
  alert('æ”¯ä»˜æˆåŠŸï¼æ„Ÿè°¢æ‚¨çš„æ”¯æŒï¼');
};
</script>

<style scoped>
.paid-prize-container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 2rem;
}

/* åŠŸèƒ½ä»‹ç»å¡ç‰‡ */
.feature-card {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  border-radius: 20px;
  padding: 3rem;
  color: white;
  margin-bottom: 3rem;
  box-shadow: 0 10px 40px rgba(102, 126, 234, 0.3);
}

.feature-header {
  text-align: center;
  margin-bottom: 3rem;
}

.feature-header h2 {
  font-size: 2.5rem;
  margin: 0 0 1rem 0;
  font-weight: bold;
}

.feature-subtitle {
  font-size: 1.2rem;
  opacity: 0.9;
  margin: 0;
}

.features-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 2rem;
}

.feature-item {
  text-align: center;
  padding: 1.5rem;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 12px;
  backdrop-filter: blur(10px);
  transition: transform 0.3s, background 0.3s;
}

.feature-item:hover {
  transform: translateY(-5px);
  background: rgba(255, 255, 255, 0.15);
}

.feature-icon {
  font-size: 3rem;
  margin-bottom: 1rem;
}

.feature-item h3 {
  font-size: 1.3rem;
  margin: 0.5rem 0;
}

.feature-item p {
  font-size: 0.95rem;
  opacity: 0.9;
  margin: 0;
}

/* ä»·æ ¼å¥—é¤éƒ¨åˆ† */
.pricing-section {
  margin-bottom: 3rem;
}

.pricing-title {
  text-align: center;
  font-size: 2rem;
  color: #333;
  margin-bottom: 2rem;
}

.pricing-cards {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 2rem;
  margin-bottom: 2rem;
  max-width: 800px;
  margin-left: auto;
  margin-right: auto;
}

.pricing-card {
  background: white;
  border-radius: 16px;
  padding: 2rem;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
  transition: all 0.3s;
  cursor: pointer;
  position: relative;
  border: 3px solid transparent;
}

.pricing-card:hover {
  transform: translateY(-8px);
  box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
}

.pricing-card.selected {
  border-color: #667eea;
  box-shadow: 0 8px 30px rgba(102, 126, 234, 0.3);
}

.pricing-card.popular {
  border-color: #f59e0b;
  transform: scale(1.05);
}

.pricing-card.popular:hover {
  transform: scale(1.08) translateY(-8px);
}

.plan-badge {
  position: absolute;
  top: -12px;
  right: 20px;
  background: #667eea;
  color: white;
  padding: 0.3rem 1rem;
  border-radius: 20px;
  font-size: 0.85rem;
  font-weight: bold;
}

.popular-badge {
  background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
}

.discount-badge {
  background: linear-gradient(135deg, #10b981 0%, #059669 100%);
}

.plan-name {
  text-align: center;
  font-size: 1.5rem;
  color: #333;
  margin: 1rem 0;
}

.plan-price {
  text-align: center;
  margin: 1.5rem 0;
}

.currency {
  font-size: 1.5rem;
  color: #666;
  vertical-align: top;
}

.amount {
  font-size: 3rem;
  font-weight: bold;
  color: #667eea;
}

.period {
  font-size: 1.2rem;
  color: #666;
}

.save-tag {
  text-align: center;
  color: #10b981;
  font-weight: bold;
  font-size: 1.1rem;
  margin: -0.5rem 0 1rem 0;
}

.plan-features {
  list-style: none;
  padding: 0;
  margin: 2rem 0;
}

.plan-features li {
  padding: 0.6rem 0;
  font-size: 1rem;
  color: #555;
}

.plan-button {
  width: 100%;
  padding: 1rem;
  border: none;
  border-radius: 8px;
  font-size: 1.1rem;
  font-weight: bold;
  cursor: pointer;
  transition: all 0.3s;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
}

.plan-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
}

.plan-button.primary {
  background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
}

.plan-button.primary:hover {
  box-shadow: 0 4px 12px rgba(245, 158, 11, 0.4);
}

/* ä½¿ç”¨è¯´æ˜ */
.instructions-card {
  background: white;
  border-radius: 16px;
  padding: 2rem;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
}

.instructions-card h3 {
  color: #333;
  font-size: 1.5rem;
  margin-bottom: 1.5rem;
}

.instructions-list {
  padding-left: 1.5rem;
  margin: 0;
}

.instructions-list li {
  padding: 0.5rem 0;
  font-size: 1.05rem;
  color: #555;
  line-height: 1.6;
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 768px) {
  .paid-prize-container {
    padding: 1rem;
  }

  .feature-card {
    padding: 2rem 1.5rem;
  }

  .feature-header h2 {
    font-size: 2rem;
  }

  .features-grid {
    grid-template-columns: 1fr;
    gap: 1rem;
  }

  .pricing-cards {
    grid-template-columns: 1fr;
    gap: 1.5rem;
  }

  .pricing-card.popular {
    transform: scale(1);
  }

  .pricing-card.popular:hover {
    transform: translateY(-8px);
  }
}
</style>
